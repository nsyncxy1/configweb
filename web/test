self.onmessage = function(e,t){e.data&&(e=e.data);var i,r,s,a,o=e.dat,c=e.par,l=[],h=[],_=[],u=e.df,g=e.t_id,f=e.t_cnt,p=e.m,m=p[c],v=e.sel,j=function e(i,r,s){s=s?s.concat():[],r&&s.unshift(r);var a,o,d,c,l=i.id.toString(),h={id:l,text:i.text||"",icon:i.icon===t||i.icon,parent:r,parents:s,children:i.children||[],children_d:i.children_d||[],data:i.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(a in u)u.hasOwnProperty(a)&&(h.state[a]=u[a]);if(i&&i.data&&i.data.jstree&&i.data.jstree.icon&&(h.icon=i.data.jstree.icon),h.icon!==t&&null!==h.icon&&""!==h.icon||(h.icon=!0),i&&i.data&&(h.data=i.data,i.data.jstree))for(a in i.data.jstree)i.data.jstree.hasOwnProperty(a)&&(h.state[a]=i.data.jstree[a]);if(i&&"object"===n(i.state))for(a in i.state)i.state.hasOwnProperty(a)&&(h.state[a]=i.state[a]);if(i&&"object"===n(i.li_attr))for(a in i.li_attr)i.li_attr.hasOwnProperty(a)&&(h.li_attr[a]=i.li_attr[a]);if(h.li_attr.id||(h.li_attr.id=l),i&&"object"===n(i.a_attr))for(a in i.a_attr)i.a_attr.hasOwnProperty(a)&&(h.a_attr[a]=i.a_attr[a]);for(i&&i.children&&!0===i.children&&(h.state.loaded=!1,h.children=[],h.children_d=[]),p[h.id]=h,a=0,o=h.children.length;a<o;a++)d=e(p[h.children[a]],h.id,s),c=p[d],h.children_d.push(d),c.children_d.length&&(h.children_d=h.children_d.concat(c.children_d));return delete i.data,delete i.children,p[h.id].original=i,h.state.selected&&_.push(h.id),h.id},k=function e(i,r,s){s=s?s.concat():[],r&&s.unshift(r);var a,o,d,c,l,h=!1;do{h="j"+g+"_"+ ++f}while(p[h]);for(a in l={id:!1,text:"string"===typeof i?i:"",icon:"object"!==n(i)||i.icon===t||i.icon,parent:r,parents:s,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},u)u.hasOwnProperty(a)&&(l.state[a]=u[a]);if(i&&i.id&&(l.id=i.id.toString()),i&&i.text&&(l.text=i.text),i&&i.data&&i.data.jstree&&i.data.jstree.icon&&(l.icon=i.data.jstree.icon),l.icon!==t&&null!==l.icon&&""!==l.icon||(l.icon=!0),i&&i.data&&(l.data=i.data,i.data.jstree))for(a in i.data.jstree)i.data.jstree.hasOwnProperty(a)&&(l.state[a]=i.data.jstree[a]);if(i&&"object"===n(i.state))for(a in i.state)i.state.hasOwnProperty(a)&&(l.state[a]=i.state[a]);if(i&&"object"===n(i.li_attr))for(a in i.li_attr)i.li_attr.hasOwnProperty(a)&&(l.li_attr[a]=i.li_attr[a]);if(l.li_attr.id&&!l.id&&(l.id=l.li_attr.id.toString()),l.id||(l.id=h),l.li_attr.id||(l.li_attr.id=l.id),i&&"object"===n(i.a_attr))for(a in i.a_attr)i.a_attr.hasOwnProperty(a)&&(l.a_attr[a]=i.a_attr[a]);if(i&&i.children&&i.children.length){for(a=0,o=i.children.length;a<o;a++)d=e(i.children[a],l.id,s),c=p[d],l.children.push(d),c.children_d.length&&(l.children_d=l.children_d.concat(c.children_d));l.children_d=l.children_d.concat(l.children)}return i&&i.children&&!0===i.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),delete i.data,delete i.children,l.original=i,p[l.id]=l,l.state.selected&&_.push(l.id),l.id};if(o.length&&o[0].id!==t&&o[0].parent!==t){for(r=0,s=o.length;r<s;r++)o[r].children||(o[r].children=[]),o[r].state||(o[r].state={}),p[o[r].id.toString()]=o[r];for(r=0,s=o.length;r<s;r++)p[o[r].parent.toString()]?(p[o[r].parent.toString()].children.push(o[r].id.toString()),m.children_d.push(o[r].id.toString())):"undefined"!==typeof d&&(d._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:o[r].id.toString(),parent:o[r].parent.toString()})},d.settings.core.error.call(d,d._data.core.last_error));for(r=0,s=m.children.length;r<s;r++)i=j(p[m.children[r]],c,m.parents.concat()),h.push(i),p[i].children_d.length&&(h=h.concat(p[i].children_d));for(r=0,s=m.parents.length;r<s;r++)p[m.parents[r]].children_d=p[m.parents[r]].children_d.concat(h);a={cnt:f,mod:p,sel:v,par:c,dpc:h,add:_}}else{for(r=0,s=o.length;r<s;r++)i=k(o[r],c,m.parents.concat()),i&&(l.push(i),h.push(i),p[i].children_d.length&&(h=h.concat(p[i].children_d)));for(m.children=l,m.children_d=h,r=0,s=m.parents.length;r<s;r++)p[m.parents[r]].children_d=p[m.parents[r]].children_d.concat(h);a={cnt:f,mod:p,sel:v,par:c,dpc:h,add:_}}if("undefined"!==typeof window&&"undefined"!==typeof window.document)return a;postMessage(a)}
